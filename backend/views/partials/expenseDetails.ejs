<!-- Expense Details -->
<div class="bg-gray-200 rounded-xl shadow-lg p-6">
  <div class="flex items-center justify-between mb-6">
    <h3 class="text-xl font-semibold text-gray-800">Expense Details</h3>
    <a href="/transactions?type=Expense" class="text-primary hover:text-secondary transition duration-200">
      <i class="fas fa-external-link-alt mr-1"></i>View All
    </a>
  </div>

  <div class="space-y-6">
    <% if (monthlyExpenses && monthlyExpenses.length > 0) { %>
      <% monthlyExpenses.forEach((expense, index) => { %>
        <% 
          const colors = ['orange', 'blue', 'purple', 'green', 'red', 'yellow', 'indigo', 'pink'];
          const color = colors[index % colors.length];
          const percentage = monthlyTotals.expenses > 0 ? (parseFloat(expense.dataValues.total) / monthlyTotals.expenses * 100) : 0;
        %>
        <div class="border-l-4 border-<%= color %>-500 pl-4">
          <div class="flex items-center justify-between mb-2">
            <h4 class="font-medium text-gray-800"><%= expense.category ? expense.category.name : 'Uncategorized' %></h4>
            <span class="text-sm font-semibold text-<%= color %>-600">$<%= parseFloat(expense.dataValues.total).toFixed(2) %></span>
          </div>
          <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
            <div class="bg-<%= color %>-500 h-2 rounded-full" style="width: <%= Math.min(percentage, 100) %>%"></div>
          </div>
          <p class="text-xs text-gray-600">This month â€¢ <%= percentage.toFixed(1) %>% of total expenses</p>
        </div>
      <% }); %>
    <% } else { %>
      <div class="text-center py-8">
        <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <i class="fas fa-arrow-down text-gray-400 text-xl"></i>
        </div>
        <p class="text-gray-500 text-sm">No expenses this month</p>
        <p class="text-gray-400 text-xs mt-1">Add your first expense transaction</p>
      </div>
    <% } %>
  </div>

  <div class="mt-6 pt-4 border-t border-gray-200">
    <div class="flex items-center justify-between mb-4">
      <span class="font-medium text-gray-700">Total Monthly Expenses</span>
      <span class="text-lg font-bold text-red-600">$<%= monthlyTotals.expenses.toFixed(2) %></span>
    </div>
    <button onclick="openTransactionModal('Expense')" class="w-full bg-red-600 text-white py-3 rounded-lg font-semibold hover:bg-red-700 transition duration-200">
      <i class="fas fa-plus mr-2"></i>Add New Expense
    </button>
  </div>
</div>